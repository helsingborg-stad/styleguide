@use "../mixin/button";
@use "../setting/var_colors";
@use "../setting/var_default";
@use "../setting/var_fonts";
@use "../setting/var_properties";

/* Component CSS Variables */

/* Accordion Typography */
$c-accordion-line-height: var(--c-accordion-line-height, var(--line-height-heading));
$c-accordion-font-weight-bold: var(--c-accordion-font-weight-bold, var(--font-weight-bold));
$c-accordion-font-family-bold: var(--c-accordion-font-family-bold, var(--font-family-base));
$c-accordion-table-font-size: var(--c-accordion-table-font-size, 0.8rem);

/* Accordion Colors */
$c-accordion-hover-background: var(--c-accordion-hover-background, var(--color--light));
$c-accordion-focus-outline-color: var(--c-accordion-focus-outline-color, var(--color--ring));
$c-accordion-spaced-background: var(--c-accordion-spaced-background, var(--color--surface));
$c-accordion-table-head-background: var(--c-accordion-table-head-background, var(--color--lighter));

/* Accordion Borders */
$c-accordion-border-width: var(--c-accordion-border-width, var(--border-width-divider));
$c-accordion-border-color: var(--c-accordion-border-color, var(--color--border));
$c-accordion-border-radius: var(--c-accordion-border-radius, var(--radius-lg));

/* Accordion Spacing */
$c-accordion-padding: var(--c-accordion-padding, var(--spacing-xs));
$c-accordion-wrapper-padding: var(--c-accordion-wrapper-padding, var(--spacing-sm));
$c-accordion-wrapper-gap: var(--c-accordion-wrapper-gap, var(--spacing-sm));
$c-accordion-content-padding: var(--c-accordion-content-padding, var(--spacing-sm));
$c-accordion-spaced-gap: var(--c-accordion-spaced-gap, var(--spacing-sm));
$c-accordion-icon-position: var(--c-accordion-icon-position, var(--spacing-md));

/* Accordion Other */
$c-accordion-margin-calculator: var(--c-accordion-scroll-margin, 0);

.c-accordion {
    padding-top: $c-accordion-padding;
    padding-bottom: $c-accordion-padding;

    &.c-accordion--flat .c-accordion__button-wrapper {
        padding-left: 0;
        padding-right: 0;

        .c-accordion__button {
            &:hover,
            &:focus {
                background-color: transparent;
                text-decoration: underline;
            }
        }
    }

    .c-accordion__button {
        @include button.button-unstyled;
        cursor: pointer;
        text-decoration: none;
        width: 100%;
        color: inherit;

        & > * {
            line-height: $c-accordion-line-height;
        }

        &:hover,
        &:focus {
            background-color: $c-accordion-hover-background;
            text-decoration: none;
        }

        .c-accordion__icon {
            transition: ease .3s transform;
        }

        &[aria-expanded="true"] {
            .c-accordion__icon {
                transform: rotate(180deg);
                transition: ease .3s transform;
            }
        }
    }

    .c-accordion__button:focus > .c-accordion__button-wrapper {
        outline-offset: 1px;
        outline: 1px dashed $c-accordion-focus-outline-color;
    }

    .c-accordion__section {
        scroll-margin-top: $c-accordion-margin-calculator;
        border-top: $c-accordion-border-width solid $c-accordion-border-color;
    }

    .c-accordion__section:first-child {
        border-top: none;
    }

    .c-accordion__button-wrapper {
        padding: $c-accordion-wrapper-padding;
        display: flex;
        gap: $c-accordion-wrapper-gap;
        align-items: center;
        font-weight: $c-accordion-font-weight-bold;
        font-family: $c-accordion-font-family-bold;
    }

    .c-accordion__icon {
        margin-left: auto;

        &:before {
            display: inline-block;
            transform: rotate(90deg);
        }
    }

    .c-accordion__content {
        padding: $c-accordion-content-padding;

        &[aria-hidden="true"] {
            display: none;
        }

        &[aria-hidden="false"] {
            display: block;
            transition: ease .3s all;
            animation-name: fadeIn;
            animation-duration: .3s;
            animation-fill-mode: both;
            will-change: transform;
        }

        *:first-child { 
            margin-top: 0; 
        }
    }

    &.c-accordion--spaced-sections {
        display: flex;
        flex-flow: row wrap;
        gap: $c-accordion-spaced-gap;
        padding: 0;

        .c-accordion__section {
            background-color: $c-accordion-spaced-background;
            border-radius: $c-accordion-border-radius;
            corner-shape: var(--corner-shape);
            border-top: 0;
            width: 100%;
        }
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }
}

/* Accordion with table columns */

.accordion-table__head {
    display: flex;
    padding: #{var(--base)} calc(#{var(--base)} * 6) #{var(--base)} calc(#{var(--base)} * 3);
    background: $c-accordion-table-head-background;
    font-size: $c-accordion-table-font-size;
}

.accordion-table__head-column-icon,
.c-accordion-table .c-icon {
    flex-grow: 0;
}

.c-accordion__button .c-accordion__button-column,
.accordion-table__head-column {
    width: 20%;
    flex-grow: 1;
}

.c-accordion-table .c-accordion__button {
    position: relative;
}

.c-accordion-table .c-accordion__icon,
.c-accordion-table .c-accordion__button[aria-expanded="true"] .c-accordion__icon {
    position: absolute;
    right: $c-accordion-icon-position;
}

// Card that has accordion with spaced sections should have no background color
.c-card:has(.c-accordion--spaced-sections) {
    background-color: transparent;
}

/* Expand accordion when print page */
@media print {
    .c-accordion .c-accordion__content[aria-hidden="true"],
    .c-accordion .c-accordion__content[aria-hidden="false"] {
        display: block;
    }
}
