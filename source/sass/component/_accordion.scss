@use "../mixin/button";
@use "../setting/var_colors";
@use "../setting/var_default";
@use "../setting/var_fonts";
@use "../setting/var_properties";

$c-accordion-border-width: var(--c-accordion-border-width, var_properties.$border-width-divider) !default;
$c-accordion-border-color: var(--c-accordion-border-color, var_colors.$color-border-divider) !default;
$c-accordion-margin-calculator: var(--c-accordion-scroll-margin, 0) !default;

.c-accordion {
    padding-top: var_default.$base;
    padding-bottom: var_default.$base;

    &.c-accordion--flat .c-accordion__button-wrapper {
        padding-left: 0;
        padding-right: 0;

        .c-accordion__button {
            &:hover,
            &:focus {
                background-color: transparent;
                text-decoration: underline;
            }
        }
    }

    .c-accordion__button {
        @include button.button-unstyled;
        cursor: pointer;
        text-decoration: none;
        width: 100%;
        color: inherit;

        & > * {
            line-height: var_fonts.$line-height-heading;
        }

        &:hover,
        &:focus {
            background-color: var_colors.$color-gray-light;
            text-decoration: none;
        }

        .c-accordion__icon {
            transition: ease .3s transform;
        }

        &[aria-expanded="true"] {
            .c-accordion__icon {
                transform: rotate(180deg);
                transition: ease .3s transform;
            }
        }
    }

    .c-accordion__button:focus > .c-accordion__button-wrapper {
        outline-offset: 1px;
        outline: 1px dashed var_colors.$color-gray;
    }

    .c-accordion__section {
        scroll-margin-top: $c-accordion-margin-calculator;
        border-top: $c-accordion-border-width solid $c-accordion-border-color;
    }

    .c-accordion__section:first-child {
        border-top: none;
    }

    .c-accordion__button-wrapper {
        padding: calc(#{var_default.$base} * 2);
        display: flex;
        gap: calc(#{var_default.$base} * 2);
        align-items: center;
        font-weight: var_fonts.$font-weight-bold;
        font-family: var_fonts.$font-family-bold;
    }

    .c-accordion__icon {
        margin-left: auto;

        &:before {
            display: inline-block;
            transform: rotate(90deg);
        }
    }

    .c-accordion__content {
        padding: calc(#{var_default.$base} * 2);

        &[aria-hidden="true"] {
            display: none;
        }

        &[aria-hidden="false"] {
            display: block;
            transition: ease .3s all;
            animation-name: fadeIn;
            animation-duration: .3s;
            animation-fill-mode: both;
            will-change: transform;
        }

        *:first-child { 
            margin-top: 0; 
        }
    }

    &.c-accordion--spaced-sections {
        display: flex;
        flex-flow: row wrap;
        gap: calc(var(--base, 8px) * 2);
        padding: 0;

        .c-accordion__section {
            background-color: var_colors.$color-background-card;
            border-radius: var(
                --c-card-border-radius,
                var(--radius-lg, calc(var(--base, 8px) / 2))
            );
            border-top: 0;
            width: 100%;
        }
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }
}

/* Accordion with table columns */

.accordion-table__head {
    display: flex;
    padding: #{var_default.$base} calc(#{var_default.$base} * 6) #{var_default.$base} calc(#{var_default.$base} * 3);
    background: #f5f5f5;
    font-size: .8rem;
}

.accordion-table__head-column-icon,
.c-accordion-table .c-icon {
    flex-grow: 0;
}

.c-accordion__button .c-accordion__button-column,
.accordion-table__head-column {
    width: 20%;
    flex-grow: 1;
}

.c-accordion-table .c-accordion__button {
    position: relative;
}

.c-accordion-table .c-accordion__icon,
.c-accordion-table .c-accordion__button[aria-expanded="true"] .c-accordion__icon {
    position: absolute;
    right: calc(#{var_default.$base} * 3);
}

// Card that has accordion with spaced sections should have no background color
.c-card:has(.c-accordion--spaced-sections) {
    background-color: transparent;
}

/* Expand accordion when print page */
@media print {
    .c-accordion .c-accordion__content[aria-hidden="true"],
    .c-accordion .c-accordion__content[aria-hidden="false"] {
        display: block;
    }
}
